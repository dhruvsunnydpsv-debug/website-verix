<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VELIX | Sovereign Apex</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        :root { 
            --bg: #ffffff; 
            --panel: rgba(255, 255, 255, 0.85); 
            --border: #e2e8f0;
            --accent: #4f46e5; /* Royal Indigo */
            --mentor: #059669; /* Emerald */
            --brutal: #dc2626; /* Crimson */
            --text: #0f172a; /* Slate 900 */
            --dim: #64748b; /* Slate 500 */
            --rainbow: linear-gradient(90deg, #ef4444, #f59e0b, #10b981, #3b82f6, #8b5cf6); 
        }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: 'Plus Jakarta Sans', sans-serif; background: var(--bg); color: var(--text); height: 100vh; display: flex; overflow: hidden; }

        /* SILK AURORA */
        .aurora { position: fixed; inset: 0; z-index: -1; background: radial-gradient(at 0% 0%, rgba(99,102,241,0.1) 0, transparent 60%), radial-gradient(at 100% 100%, rgba(236,72,153,0.1) 0, transparent 60%); background-image: radial-gradient(at 50% 50%, #f8fafc 0, transparent 50%); animation: pulse 12s infinite; }
        @keyframes pulse { 0% { opacity: 0.5; } 50% { opacity: 1; } 100% { opacity: 0.5; } }

        /* LOADING SCREEN - CINEMATIC */
        #loader { position: fixed; inset: 0; background: white; z-index: 9999; display: flex; flex-direction: column; align-items: center; justify-content: center; transition: opacity 0.8s ease-out; }
        .loader-bar { width: 300px; height: 4px; background: #f1f5f9; margin-top: 20px; border-radius: 4px; overflow: hidden; }
        .loader-fill { height: 100%; width: 0%; background: var(--accent); transition: width 2s cubic-bezier(0.22, 1, 0.36, 1); }
        .loader-text { font-size: 14px; font-weight: 800; letter-spacing: 4px; color: var(--accent); margin-bottom: 15px; animation: blink 1s infinite; }
        @keyframes blink { 50% { opacity: 0.5; } }

        /* VISION OVERLAY - THE GUIDE */
        #vision-overlay { position: fixed; inset: 0; background: rgba(255,255,255,0.95); z-index: 2000; display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 20px; backdrop-filter: blur(20px); transition: opacity 0.5s; }
        .v-container { width: 100%; max-width: 1000px; background: white; border: 1px solid var(--border); border-radius: 32px; padding: 60px; box-shadow: 0 20px 80px rgba(0,0,0,0.05); text-align: center; position: relative; overflow: hidden; }
        
        .slide { display: none; animation: fadeIn 0.5s; }
        .slide.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        .v-header { font-size: 64px; font-weight: 900; background: var(--rainbow); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 20px; letter-spacing: -2px; }
        .v-sub { font-size: 24px; color: var(--text); font-weight: 800; margin-bottom: 30px; }
        .v-desc { font-size: 18px; line-height: 1.8; color: var(--dim); margin-bottom: 40px; max-width: 700px; margin-left: auto; margin-right: auto; }

        .feature-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; margin-top: 30px; text-align: left; }
        .f-card { padding: 20px; border: 1px solid var(--border); border-radius: 16px; background: #f8fafc; }
        .f-card h4 { color: var(--accent); margin-bottom: 8px; font-weight: 800; }
        .f-card p { font-size: 13px; color: var(--dim); line-height: 1.5; }

        .btn-large { padding: 20px 50px; background: var(--text); color: white; border: none; border-radius: 100px; font-weight: 800; font-size: 16px; cursor: pointer; transition: 0.2s; margin-top: 30px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        .btn-large:hover { transform: scale(1.05); }

        /* SIDEBAR */
        .sidebar { width: 320px; background: var(--panel); border-right: 1px solid var(--border); padding: 40px 25px; display: flex; flex-direction: column; backdrop-filter: blur(30px); }
        .logo { font-size: 28px; font-weight: 900; margin-bottom: 50px; color: var(--text); letter-spacing: -1px; display: flex; align-items: center; gap: 10px; }
        .logo span { background: var(--rainbow); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        
        .nav-cat { font-size: 11px; font-weight: 800; color: var(--dim); text-transform: uppercase; letter-spacing: 1px; margin: 25px 0 10px 10px; }
        .nav-btn { width: 100%; padding: 16px; border-radius: 14px; border: 1px solid transparent; background: transparent; color: var(--dim); text-align: left; font-weight: 700; cursor: pointer; margin-bottom: 4px; display: flex; align-items: center; gap: 12px; transition: 0.2s; }
        .nav-btn:hover { background: #f1f5f9; color: var(--text); }
        .nav-btn.active { background: white; color: var(--accent); border-color: var(--border); box-shadow: 0 4px 12px rgba(0,0,0,0.05); }

        /* WORKSPACE */
        .workspace { flex: 1; display: flex; flex-direction: column; padding: 50px; position: relative; }
        
        .mode-container { display: flex; gap: 15px; margin-bottom: 30px; }
        .mode-card { flex: 1; background: white; border: 1px solid var(--border); padding: 20px; border-radius: 16px; cursor: pointer; transition: 0.3s; display: flex; align-items: center; gap: 15px; opacity: 0.7; box-shadow: 0 2px 10px rgba(0,0,0,0.02); }
        .mode-card:hover { opacity: 1; transform: translateY(-2px); }
        .mode-card.active { opacity: 1; border-color: currentColor; box-shadow: 0 8px 20px rgba(0,0,0,0.05); }
        .mc-icon { font-size: 24px; }
        .mc-info h3 { font-size: 14px; font-weight: 800; margin-bottom: 4px; color: var(--text); }
        .mc-info p { font-size: 11px; color: var(--dim); }

        .toolbar { display: none; gap: 15px; margin-bottom: 25px; flex-wrap: wrap; }
        .toolbar.active { display: flex; }
        input, select { background: white; border: 1px solid var(--border); padding: 16px; border-radius: 12px; color: var(--text); font-weight: 600; outline: none; font-size: 13px; flex: 1; min-width: 140px; transition: 0.2s; box-shadow: 0 2px 5px rgba(0,0,0,0.02); }
        input:focus, select:focus { border-color: var(--accent); box-shadow: 0 0 0 3px rgba(99,102,241,0.1); }
        
        textarea { flex: 1; background: transparent; border: none; outline: none; color: var(--text); font-size: 22px; font-weight: 500; line-height: 1.6; resize: none; margin-bottom: 20px; }
        
        /* VOICE PANEL */
        #voice-panel { display: none; gap: 15px; margin-bottom: 25px; background: white; padding: 20px; border-radius: 20px; border: 1px solid var(--border); box-shadow: 0 4px 20px rgba(0,0,0,0.03); }
        .v-stat { flex: 1; text-align: center; }
        .v-val { font-size: 24px; font-weight: 900; color: var(--text); }
        
        /* ANALYTICS */
        .analytics { width: 460px; background: white; border-left: 1px solid var(--border); padding: 50px; overflow-y: auto; display: flex; flex-direction: column; }
        .grade-box { text-align: center; margin-bottom: 40px; }
        .grade { font-size: 100px; font-weight: 900; line-height: 1; margin-bottom: 10px; color: var(--text); letter-spacing: -4px; }
        .grade-sub { font-size: 12px; font-weight: 800; color: var(--dim); letter-spacing: 2px; text-transform: uppercase; }
        
        .result-card { background: #f8fafc; border: 1px solid var(--border); padding: 30px; border-radius: 24px; margin-bottom: 20px; }
        .rc-label { font-size: 10px; font-weight: 900; text-transform: uppercase; color: var(--dim); margin-bottom: 15px; display: block; letter-spacing: 2px; }
        
        .btn-action { width: 100%; padding: 22px; border-radius: 18px; background: var(--text); color: white; border: none; font-weight: 800; text-transform: uppercase; letter-spacing: 1px; cursor: pointer; transition: 0.2s; font-size: 14px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        .btn-action:hover { transform: translateY(-2px); box-shadow: 0 15px 40px rgba(0,0,0,0.15); }
    </style>
</head>
<body>
    <div class="aurora"></div>

    <div id="loader">
        <div class="loader-text">INITIALIZING VELIX CORE</div>
        <div class="loader-bar"><div class="loader-fill" id="l-fill"></div></div>
    </div>

    <div id="vision-overlay">
        <div class="v-container slide active" id="slide-1">
            <h1 class="v-header">VELIX SOVEREIGN</h1>
            <p class="v-sub">The Antidote to Mediocrity.</p>
            <p class="v-desc">Most AI tools are polite. They sugarcoat your mistakes. <b>VELIX is different.</b> It is a Dual-Core Audit Engine designed to ruthlessly dismantle weak logic or strategically mentor you toward excellence.</p>
            <button class="btn-large" onclick="changeSlide(2)">NEXT: HOW TO USE</button>
        </div>

        <div class="v-container slide" id="slide-2">
            <h1 class="v-header" style="font-size: 48px;">THE DUAL ENGINE</h1>
            <p class="v-desc">You are in control. Choose your operating mode before every audit.</p>
            <div class="feature-grid" style="grid-template-columns: 1fr 1fr; gap: 30px; margin-bottom: 30px;">
                <div class="f-card" style="border-left: 4px solid var(--brutal);">
                    <h4 style="color: var(--brutal);">‚öîÔ∏è TOUGH COACH</h4>
                    <p>Zero empathy. Logic flaws are destroyed. Best for stress-testing ideas and finding weak spots.</p>
                </div>
                <div class="f-card" style="border-left: 4px solid var(--mentor);">
                    <h4 style="color: var(--mentor);">üåø MENTOR MODE</h4>
                    <p>Constructive guidance. Focuses on potential, actionable steps, and strategic improvement.</p>
                </div>
            </div>
            <button class="btn-large" onclick="changeSlide(3)">NEXT: THE TOOLS</button>
        </div>

        <div class="v-container slide" id="slide-3">
            <h1 class="v-header" style="font-size: 48px;">YOUR ARSENAL</h1>
            <div class="feature-grid">
                <div class="f-card"><h4>‚ö° Generator</h4><p>High-velocity creation for LinkedIn, Twitter, and Email.</p></div>
                <div class="f-card"><h4>üìù Writing</h4><p>Deep audit for Grammar, Logic Flow, and Persuasion.</p></div>
                <div class="f-card"><h4>üéôÔ∏è Voice Lab</h4><p>Real-time WPM tracking and speech analysis.</p></div>
                <div class="f-card"><h4>üé® Art Audit</h4><p>Aesthetic check for Golden Ratio and Color Theory.</p></div>
                <div class="f-card"><h4>üöÄ Architect</h4><p>Execution pathfinding for complex projects.</p></div>
                <div class="f-card"><h4>üìà History</h4><p>Live session logging to track your improvement.</p></div>
            </div>
            <button class="btn-large" style="background: var(--accent);" onclick="closeVision()">ENTER COMMAND CENTER</button>
        </div>
    </div>

    <aside class="sidebar">
        <div class="logo">VELIX <span>APEX</span></div>
        <div class="nav-cat">Creation Engine</div>
        <button class="nav-btn active" id="nav-gen" onclick="setTab('gen')">‚ö° Generator</button>
        <button class="nav-btn" id="nav-text" onclick="setTab('text')">üìù Writing Audit</button>
        <button class="nav-btn" id="nav-voice" onclick="setTab('voice')">üéôÔ∏è Voice Lab</button>
        <div class="nav-cat">Specialized</div>
        <button class="nav-btn" id="nav-art" onclick="setTab('art')">üé® Art Audit</button>
        <button class="nav-btn" id="nav-arc" onclick="setTab('arc')">üöÄ Architect</button>
        <div style="margin-top: auto; background: white; padding: 20px; border-radius: 16px; border: 1px solid var(--border);">
            <div class="nav-cat" style="margin-top:0">Session Log</div>
            <div id="history-log" style="max-height: 150px; overflow-y: auto; font-size: 11px; color: var(--dim); display: flex; flex-direction: column; gap: 8px;"></div>
        </div>
    </aside>

    <main class="workspace">
        <div class="mode-container">
            <div class="mode-card active" id="card-brutal" onclick="setMode('brutal')" style="color: var(--brutal)">
                <div class="mc-icon">‚öîÔ∏è</div>
                <div class="mc-info"><h3>TOUGH COACH</h3><p>Brutal honesty. Logic dismantling.</p></div>
            </div>
            <div class="mode-card" id="card-mentor" onclick="setMode('mentor')" style="color: var(--mentor)">
                <div class="mc-icon">üåø</div>
                <div class="mc-info"><h3>MENTOR MODE</h3><p>Strategic guidance. Growth focus.</p></div>
            </div>
        </div>

        <div id="tool-gen" class="toolbar active">
            <input id="g-topic" placeholder="The Objective">
            <input id="g-tone" placeholder="Desired Tone">
            <select id="g-format"><option>LinkedIn Post</option><option>Twitter Thread</option><option>Cold Email</option></select>
        </div>
        <div id="tool-text" class="toolbar">
            <select id="t-focus"><option>Logic & Flow</option><option>Grammar</option><option>Persuasion</option></select>
            <input id="t-aud" placeholder="Target Audience">
        </div>
        <div id="voice-panel">
            <div class="v-stat"><div class="v-val" id="wpm">0</div><div style="font-size:10px; color:var(--dim)">WPM</div></div>
            <div class="v-stat"><div class="v-val" id="dur">00:00</div><div style="font-size:10px; color:var(--dim)">DURATION</div></div>
            <button onclick="toggleRec()" style="flex:2; background:#ef4444; border:none; color:white; border-radius:12px; font-weight:800; cursor:pointer;">üî¥ REC / STOP</button>
        </div>
        <div id="tool-art" class="toolbar">
            <input id="a-style" placeholder="Style (e.g. Bauhaus)">
            <select id="a-comp"><option>Rule of Thirds</option><option>Golden Ratio</option></select>
        </div>
        <div id="tool-arc" class="toolbar">
            <input id="arc-goal" placeholder="The Final Goal">
            <select id="arc-res"><option>Low Budget</option><option>Unlimited</option></select>
        </div>

        <textarea id="main-input" placeholder="Awaiting raw data for sovereign processing..."></textarea>
        <button class="btn-action" onclick="ignite()" id="action-btn">INITIATE AUDIT</button>
    </main>

    <aside class="analytics">
        <div class="grade-box">
            <div class="grade" id="grade">--</div>
            <div class="grade-sub" id="grade-sub">STATUS: IDLE</div>
        </div>
        <div class="result-card" id="card-feedback" style="border-left: 4px solid var(--brutal);">
            <span class="rc-label" id="lbl-feedback" style="color: var(--brutal);">THE REALITY CHECK</span>
            <p id="txt-feedback" style="font-size: 18px; font-weight: 700; color: var(--text); line-height: 1.4;">Awaiting input...</p>
        </div>
        <div class="result-card">
            <span class="rc-label">SOVEREIGN VERSION</span>
            <p id="txt-enhance" style="font-size: 14px; color: var(--dim); line-height: 1.7; margin-bottom: 20px;">No data analyzed.</p>
            <button onclick="playAudio()" style="background:white; border:1px solid var(--border); color:var(--text); padding:12px; width:100%; border-radius:12px; font-weight:700; cursor:pointer; font-size: 11px; box-shadow: 0 4px 10px rgba(0,0,0,0.05);">üîä PLAY AUDIO</button>
        </div>
    </aside>

    <script>
        const KEY = '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';
        let state = { tab: 'gen', mode: 'brutal' };
        let recognition, timer, startTime;

        // LOADING & ONBOARDING
        window.onload = () => {
            document.getElementById('l-fill').style.width = '100%';
            setTimeout(() => {
                document.getElementById('loader').style.opacity = '0';
                setTimeout(() => {
                    document.getElementById('loader').style.display = 'none';
                }, 800);
            }, 1500);
        };

        function changeSlide(n) {
            document.querySelectorAll('.slide').forEach(s => s.classList.remove('active'));
            document.getElementById(`slide-${n}`).classList.add('active');
        }

        function closeVision() { 
            document.getElementById('vision-overlay').style.opacity = '0';
            setTimeout(() => document.getElementById('vision-overlay').style.display = 'none', 500);
        }

        function setTab(t) {
            state.tab = t;
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.toggle('active', b.id.includes(t)));
            document.querySelectorAll('.toolbar').forEach(b => b.classList.toggle('active', b.id.includes(t)));
            document.getElementById('voice-panel').style.display = t === 'voice' ? 'flex' : 'none';
            document.getElementById('main-input').value = "";
        }

        function setMode(m) {
            state.mode = m;
            document.querySelectorAll('.mode-card').forEach(c => c.classList.remove('active'));
            document.getElementById(`card-${m}`).classList.add('active');
            const color = m === 'brutal' ? '#ef4444' : '#10b981';
            const label = m === 'brutal' ? "THE REALITY CHECK" : "GROWTH STRATEGY";
            document.getElementById('card-feedback').style.borderLeftColor = color;
            document.getElementById('lbl-feedback').innerText = label;
            document.getElementById('lbl-feedback').style.color = color;
            document.getElementById('action-btn').style.background = m === 'brutal' ? '#ef4444' : '#10b981';
            document.getElementById('action-btn').innerText = m === 'brutal' ? "DISMANTLE WEAKNESS" : "ELEVATE POTENTIAL";
        }

        function toggleRec() {
            if(!recognition) {
                recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
                recognition.continuous = true;
                recognition.onresult = e => {
                    const txt = e.results[e.results.length-1][0].transcript;
                    document.getElementById('main-input').value += txt + " ";
                    const wpm = Math.round(document.getElementById('main-input').value.split(' ').length / ((new Date() - startTime)/60000));
                    document.getElementById('wpm').innerText = wpm || 0;
                };
            }
            if(timer) {
                recognition.stop();
                clearInterval(timer);
                timer = null;
            } else {
                recognition.start();
                startTime = new Date();
                timer = setInterval(() => {
                    const diff = Math.floor((new Date() - startTime)/1000);
                    const m = Math.floor(diff/60).toString().padStart(2,'0');
                    const s = (diff%60).toString().padStart(2,'0');
                    document.getElementById('dur').innerText = `${m}:${s}`;
                }, 1000);
            }
        }

        async function ignite() {
            const btn = document.getElementById('action-btn');
            const input = document.getElementById('main-input').value;
            const gradeDisplay = document.getElementById('grade');
            const subDisplay = document.getElementById('grade-sub');
            
            // ERROR HANDLING: PREVENT UNDEFINED
            if(!input || input.trim().length === 0) {
                gradeDisplay.innerText = "NULL";
                gradeDisplay.style.color = "#94a3b8";
                subDisplay.innerText = "ERROR: ENTER DATA";
                return;
            }
            if(input.trim().length < 10) {
                gradeDisplay.innerText = "LOW";
                gradeDisplay.style.color = "#ef4444";
                subDisplay.innerText = "ERROR: INPUT TOO SHORT";
                return;
            }

            btn.innerText = "PROCESSING...";
            
            const coachPrompt = `You are VELIX. Mode: TOUGH COACH. 
            Do NOT act like a yes-man. Do NOT sugarcoat. 
            Challenge opinions. Call out logic flaws. Be direct, raw, and evidence-backed. 
            JSON ONLY: {"grade": "S/A/B/C/D/F", "feedback": "Direct, actionable critique (max 2 sentences)", "enhance": "Rewrite the user's input to be elite."}`;

            const mentorPrompt = `You are VELIX. Mode: MENTOR. 
            Be constructive, encouraging, and strategic. Focus on potential. 
            JSON ONLY: {"grade": "S/A/B/C/D/F", "feedback": "Helpful advice (max 2 sentences)", "enhance": "Improved version."}`;

            try {
                const r = await fetch("https://openrouter.ai/api/v1/chat/completions", {
                    method: 'POST',
                    headers: {'Authorization': `Bearer ${KEY}`, 'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        model: "google/gemini-2.0-flash-001",
                        messages: [
                            {role: "system", content: state.mode === 'brutal' ? coachPrompt : mentorPrompt}, 
                            {role: "user", content: input}
                        ],
                        response_format: { type: "json_object" }
                    })
                });
                
                const d = await r.json();
                
                // API KEY SAFETY CHECK
                if (d.error) {
                    throw new Error("API Key Error");
                }
                if (!d.choices || !d.choices[0]) {
                    throw new Error("No Data");
                }

                const res = JSON.parse(d.choices[0].message.content);

                if(!res.grade) {
                    gradeDisplay.innerText = "ERR";
                    subDisplay.innerText = "AI PARSE ERROR";
                } else {
                    gradeDisplay.innerText = res.grade;
                    gradeDisplay.style.color = state.mode === 'brutal' ? '#ef4444' : '#10b981';
                    subDisplay.innerText = "SOVEREIGN RANK";
                    document.getElementById('txt-feedback').innerText = res.feedback;
                    document.getElementById('txt-enhance').innerText = res.enhance;

                    const logItem = document.createElement('div');
                    logItem.innerHTML = `<span style="color:${state.mode==='brutal'?'#ef4444':'#10b981'}">‚óè</span> ${new Date().toLocaleTimeString()} - Rank ${res.grade}`;
                    document.getElementById('history-log').prepend(logItem);
                }

            } catch(e) { 
                console.error(e); 
                gradeDisplay.innerText = "KEY";
                gradeDisplay.style.color = "#ef4444";
                subDisplay.innerText = "EXPIRED OR ERROR";
            }
            
            btn.innerText = state.mode === 'brutal' ? "DISMANTLE WEAKNESS" : "ELEVATE POTENTIAL";
        }

        function playAudio() {
            const u = new SpeechSynthesisUtterance(document.getElementById('txt-enhance').innerText);
            window.speechSynthesis.speak(u);
        }
    </script>
</body>
</html>
